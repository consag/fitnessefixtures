---
Help
Suites
Test
---
----

![?
Department:?Data Logistics and Distribution 
From --> To:?Siebel --> EB2 --> DWH-D
Subject:?SaccntSrc
Testtype:?Systemtest
Run indication:?InitalRun
Action:?Inserted/Updated/Deleted -- Edit manually!
]!




!define TEST_SYSTEM {slim} 
!path ../fitnesse/java_workspace/fixtures
!path ../fitnesse/java_workspace/fixtures
!path ../fitnesse/sqldeveloper/jdbc/lib/ojdbc6.jar
!path ../fitnesse/ibm/db2jcc_license_cisuz.jar
!path ../fitnesse/ibm/db2jcc.jar
!path ../fitnesse/netezza/nzjdbc.jar
!path ../fitnesse/hpnonstop/t4sqlmx.jar
!path ../fitnesse/ms/sqljdbc4.jar
!path ../fitnesse/java_workspace/fixtures/generic/fixtures/PowerCenterWS

!|import                       |
|generic.fixtures.Global      |
|generic.fixtures.PWCFixture  |
|generic.fixtures.LinuxFixture|
|generic.fixtures.DBFixture   |
|generic.fixtures.DACFixture  |

----
!define variable {myDelSqn}
!define variable {myLoadDts}
----



''' Siebel '''

!style_meta[Verify that the record does exist in siebel.]

#1 Verify the attributes for the given ROW_ID Siebel
|table:select query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|database name|SIEBEL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|sql statement|!-SELECT  ROW_ID, OBJECTIVE from s_accnt_src where row_id='1-JBE01' with ur -!|
|column name  |ROW_ID               |OBJECTIVE|
|column value |!-1-JBE01-!  |!-Distributiekanaal: via intern communicatiesysteem Rabobank

Deze klant is in het kader van de actie EDM-Bedrijven geselecteerd. Deze klant heeft een lening waarvan de rentevast periode binnen twee maanden afloopt. U dient contact op te nemen met de klant. Meer informatie over dit signaal vindt u op het Raboweb onder Bedrijven/Informatie/Marktbewerking/EDM.

Leningnummer: 1049913027
Rentefixatiedatum: 28-02-2005
Boeksaldo: 50.878
Rest. looptyd (mnd): 112
Huidig rentetype: C
KBM-cluster: 3
Rente afspraak: Vast-!|
 

''' EB2 ''' 

!style_meta[Verify that the record does exist in EB2.]

|table:select query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|database name|EB2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|sql statement|!-SELECT  INTEGRATION_ID, CREATED, CREATED_BY, LAST_UPD, LAST_UPD_BY, ACTIVE_FLG, ACTL_BILL_BACK, ACTL_DISPLAY_COST, ACTL_FEATURE_COST, ACTL_NUM_RED_COUPN, ACTL_NUM_SCAN_RED, ACTL_OTHER_COST, ACTL_SPENT_AMT, ACTL_TOT_COUPON, ACTL_VAL_COUPON, ACTL_VAL_SCAN_RED, ACTL_XINV_CASERATE, ACTUAL_TGT_AMT, ADVERT_DESC_TEXT, ALLOCATED_AMT, AMT_CURCY_CD, AMT_DT, ASGN_DT, ATTRIB_01, ATTRIB_02, ATTRIB_03, ATTRIB_04, ATTRIB_05, ATTRIB_06, CMMT_BILL_BACK, CMMT_DISPLAY_COST, CMMT_FEATURE_COST, CMMT_NUM_RED_COUPN, CMMT_NUM_SCAN_RED, CMMT_OTHER_COST, CMMT_TOT_COUPON, CMMT_VAL_COUPON, CMMT_VAL_SCAN_RED, CMMT_XINV_CASERATE, COMMENTS, COMMITTED_AMT, COMMITTED_FLG, CONFLICT_ID, CONSUME_END_DT, CONSUME_START_DT, COUPON_DROP_FLG, DB_LAST_UPD, DB_LAST_UPD_SRC, DISPLAY_FLG, END_DT, FEATURE_DT, FEATURE_FLG, FORWARD_BUY_AMT, INCR_COST_PER_CASE, INCR_PROF_PER_CASE, INCR_VOLUME, X_SBL_INTEGRATION_ID, MODIFICATION_NUM, OBJECTIVE, OTH_COST_DSCTXT, OU_EXT_ID, PACKAGE_DESC_TEXT, PAR_ACCNT_SRC_ID, PAY_END_DT, PAY_EXPECT_DT, PAY_START_DT, PCT_LIFT, PERIOD_ID, PRICE_POINT, PRIMARY_FLG, PRI_LST_ID, PR_ACCNT_SRCPLN_ID, PR_ACCNT_SRC_PI_ID, READ_ONLY_FLG, RET_CAT_LIFT_PCT, RET_PROF_INCR_CASE, RET_PROMO_EFFIC, REV_DT, REV_NUM, SHIP_END_DT, SHIP_START_DT, SPENDING_EFFIC_IND, SRC_ID, START_DT, STATUS_CD, TGTREV_CURCY_CD, TGTREV_EXCH_DT, TGT_REVN, TMP_PRI_RDX_FLG, TMP_PRI_RDX_PCT, TURN_VOL_AMT, X_ASGN_USR_EXC_FLG, X_BU_ID, X_CALL_COMPLETED, X_CHANNEL_USED_CD, X_EXPIRATION_DT, X_FILE_NUM, X_FOLLOW_UP_FLG, X_FUNCTION_ID, X_OUTCOME_CD, X_PLAN_DT, X_POSTN_ID, X_PRIORITY_CD, X_PR_REP_DNRM_FLG, X_PR_REP_MANL_FLG, X_PR_REP_SYS_FLG, X_RANKING_NUM, X_RB_CHANGE_DT, X_ROLE_CD, X_SIGNAL_TYPE_CD, X_SOURCE, X_SOURCE_2, X_START_DT, X_STAT_CD, X_TARGET_GRP_CD, X_PART_KEY, DATASOURCE_NUM_ID, DELETE_FLG FROM WC_ACCNT_SRC_G WHERE INTEGRATION_ID = '1-3456Abc011245'-!|
|column name  |INTEGRATION_ID       |CREATED                         |CREATED_BY  |LAST_UPD                        |LAST_UPD_BY    |ACTIVE_FLG  |ACTL_BILL_BACK  |ACTL_DISPLAY_COST  |ACTL_FEATURE_COST  |ACTL_NUM_RED_COUPN  |ACTL_NUM_SCAN_RED  |ACTL_OTHER_COST  |ACTL_SPENT_AMT  |ACTL_TOT_COUPON  |ACTL_VAL_COUPON  |ACTL_VAL_SCAN_RED  |ACTL_XINV_CASERATE  |ACTUAL_TGT_AMT  |ADVERT_DESC_TEXT  |ALLOCATED_AMT  |AMT_CURCY_CD |AMT_DT |ASGN_DT |ATTRIB_01 |ATTRIB_02 |ATTRIB_03 |ATTRIB_04 |ATTRIB_05 |ATTRIB_06 |CMMT_BILL_BACK |CMMT_DISPLAY_COST |CMMT_FEATURE_COST |CMMT_NUM_RED_COUPN |CMMT_NUM_SCAN_RED |CMMT_OTHER_COST |CMMT_TOT_COUPON |CMMT_VAL_COUPON |CMMT_VAL_SCAN_RED |CMMT_XINV_CASERATE |COMMENTS |COMMITTED_AMT |COMMITTED_FLG |CONFLICT_ID |CONSUME_END_DT |CONSUME_START_DT |COUPON_DROP_FLG |DB_LAST_UPD |DB_LAST_UPD_SRC |DISPLAY_FLG |END_DT |FEATURE_DT |FEATURE_FLG |FORWARD_BUY_AMT |INCR_COST_PER_CASE |INCR_PROF_PER_CASE |INCR_VOLUME |X_SBL_INTEGRATION_ID |MODIFICATION_NUM |OBJECTIVE |OTH_COST_DSCTXT |OU_EXT_ID |PACKAGE_DESC_TEXT |PAR_ACCNT_SRC_ID |PAY_END_DT |PAY_EXPECT_DT |PAY_START_DT |PCT_LIFT |PERIOD_ID |PRICE_POINT |PRIMARY_FLG |PRI_LST_ID |PR_ACCNT_SRCPLN_ID |PR_ACCNT_SRC_PI_ID |READ_ONLY_FLG |RET_CAT_LIFT_PCT |RET_PROF_INCR_CASE |RET_PROMO_EFFIC |REV_DT |REV_NUM |SHIP_END_DT |SHIP_START_DT |SPENDING_EFFIC_IND |SRC_ID |START_DT |STATUS_CD |TGTREV_CURCY_CD |TGTREV_EXCH_DT |TGT_REVN |TMP_PRI_RDX_FLG |TMP_PRI_RDX_PCT |TURN_VOL_AMT |X_ASGN_USR_EXC_FLG |X_BU_ID |X_CALL_COMPLETED |X_CHANNEL_USED_CD |X_EXPIRATION_DT |X_FILE_NUM |X_FOLLOW_UP_FLG |X_FUNCTION_ID |X_OUTCOME_CD |X_PLAN_DT |X_POSTN_ID |X_PRIORITY_CD |X_PR_REP_DNRM_FLG |X_PR_REP_MANL_FLG |X_PR_REP_SYS_FLG |X_RANKING_NUM |X_RB_CHANGE_DT |X_ROLE_CD |X_SIGNAL_TYPE_CD |X_SOURCE |X_SOURCE_2 |X_START_DT |X_STAT_CD |X_TARGET_GRP_CD |X_PART_KEY |DATASOURCE_NUM_ID |DELETE_FLG |
|column value |!-1-3456Abc011245-!  |!-2014-01-15 08:47:43.456321-!  |!-0-1-!     |!-2014-01-15 07:47:43.786795-!  |!-1-9X-9381-!  |!--!        |!--!            |!--!               |!--!               |!--!                |!--!               |!--!             |!--!            |!--!             |!--!             |!--!               |!--!                |!--!            |!--!              |!--!           |!-USD-!      |!--!   |!--!    |!--!      |!--!      |!--!      |!--!      |!--!      |!--!      |!--!           |!--!              |!--!              |!--!               |!--!              |!--!            |!--!            |!--!            |!--!              |!--!               |!--!     |!--!          |!--!          |!-0-!       |!--!           |!--!             |!--!            |!--!        |!--!            |!--!        |!--!   |!--!       |!--!        |!--!            |!--!               |!--!               |!--!        |!--!                 |!-6-!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |!-

Distributiekanaal: via intern communicatiesysteem Rabobank

Deze klant is in het kader van de actie EDM-Bedrijven geselecteerd. Deze klant heeft een lening waarvan de rentevast periode binnen twee maanden afloopt. U dient contact op te nemen met de klant. Meer informatie over dit signaal vindt u op het Raboweb onder Bedrijven/Informatie/Marktbewerking/EDM.

Leningnummer: 1049913027
Rentefixatiedatum: 28-02-2005
Boeksaldo: 50.878
Rest. looptyd (mnd): 112
Huidig rentetype: C
KBM-cluster: 3
Rente afspraak: Vast-!|!--!|!-1-3EEA-12-!|!--!|!--!|!--!|!-2005-01-14 07:01:00-!|!-2004-12-28 05:51:36-!|!--!|!--!|!--!|!--!|!--!|!--!|!--!|!-Y-!|!--!|!--!|!--!|!--!|!-1000004001-!|!--!|!--!|!--!|!-1-1O96-63-!|!--!|!--!|!--!|!--!|!--!|!--!|!--!|!--!|!--!|!-1-1U-253-!|!-Y-!|!--!|!--!|!--!|!--!|!--!|!--!|!-2005-01-14 07:01:00-!|!-1-9J-9399-!|!-3. Midden-!|!--!|!--!|!--!|!--!|!--!|!--!|!--!|!-CRIS-!|!-MDB-!|!--!|!-Afgehandeld-!|!--!|!-1049-!|!-1-!|!-N-!|
 

''' DWDH  ''' 

!style_meta[Verify that the record and handshake data exists in DWH-D.]

#3 ophalen delivery_sqn en load_dts
|get query result                                                                                                                                                                            |
|database name|query                                                                                                                                      |get column ?   |get log filename ?|
|DWHD_IN      |!-SELECT max (delivery_sqn) FROM mrv_data_delivery WHERE interface_code = 'WC_ACCNT_SRC_G' and rec_src = 'Siebel/EB2' and scheme = 'PUSH'-!|!-$myDelSqn=-! |                  |
|DWHD_IN      |!-SELECT load_dts FROM mrv_data_delivery_detail WHERE delivery_sqn = $myDelSqn-!                                                           |!-$myLoadDts=-!|                  |
|DWHD_IN      |!-SELECT load_dts FROM STI_WC_ACCNT_SRC_G WHERE INTEGRATION_ID = '1-3456Abc011245' and delivery_sqn = $myDelSqn-!                          |!-$myLoadDts=-!|                  |

#4 Check if the data is correct in the STUB
|table:select query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|database name|DWHD_IN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|sql statement|!-select  INTEGRATION_ID, CREATED, CREATED_BY, LAST_UPD, LAST_UPD_BY, ACTIVE_FLG, ACTL_BILL_BACK, ACTL_DISPLAY_COST, ACTL_FEATURE_COST, ACTL_NUM_RED_COUPN, ACTL_NUM_SCAN_RED, ACTL_OTHER_COST, ACTL_SPENT_AMT, ACTL_TOT_COUPON, ACTL_VAL_COUPON, ACTL_VAL_SCAN_RED, ACTL_XINV_CASERATE, ACTUAL_TGT_AMT, ADVERT_DESC_TEXT, ALLOCATED_AMT, AMT_CURCY_CD, AMT_DT, ASGN_DT, ATTRIB_01, ATTRIB_02, ATTRIB_03, ATTRIB_04, ATTRIB_05, ATTRIB_06, CMMT_BILL_BACK, CMMT_DISPLAY_COST, CMMT_FEATURE_COST, CMMT_NUM_RED_COUPN, CMMT_NUM_SCAN_RED, CMMT_OTHER_COST, CMMT_TOT_COUPON, CMMT_VAL_COUPON, CMMT_VAL_SCAN_RED, CMMT_XINV_CASERATE, COMMENTS, COMMITTED_AMT, COMMITTED_FLG, CONFLICT_ID, CONSUME_END_DT, CONSUME_START_DT, COUPON_DROP_FLG, DB_LAST_UPD, DB_LAST_UPD_SRC, DISPLAY_FLG, END_DT, FEATURE_DT, FEATURE_FLG, FORWARD_BUY_AMT, INCR_COST_PER_CASE, INCR_PROF_PER_CASE, INCR_VOLUME, X_SBL_INTEGRATION_ID, MODIFICATION_NUM, OBJECTIVE, OTH_COST_DSCTXT, OU_EXT_ID, PACKAGE_DESC_TEXT, PAR_ACCNT_SRC_ID, PAY_END_DT, PAY_EXPECT_DT, PAY_START_DT, PCT_LIFT, PERIOD_ID, PRICE_POINT, PRIMARY_FLG, PRI_LST_ID, PR_ACCNT_SRCPLN_ID, PR_ACCNT_SRC_PI_ID, READ_ONLY_FLG, RET_CAT_LIFT_PCT, RET_PROF_INCR_CASE, RET_PROMO_EFFIC, REV_DT, REV_NUM, SHIP_END_DT, SHIP_START_DT, SPENDING_EFFIC_IND, SRC_ID, START_DT, STATUS_CD, TGTREV_CURCY_CD, TGTREV_EXCH_DT, TGT_REVN, TMP_PRI_RDX_FLG, TMP_PRI_RDX_PCT, TURN_VOL_AMT, X_ASGN_USR_EXC_FLG, X_BU_ID, X_CALL_COMPLETED, X_CHANNEL_USED_CD, X_EXPIRATION_DT, X_FILE_NUM, X_FOLLOW_UP_FLG, X_FUNCTION_ID, X_OUTCOME_CD, X_PLAN_DT, X_POSTN_ID, X_PRIORITY_CD, X_PR_REP_DNRM_FLG, X_PR_REP_MANL_FLG, X_PR_REP_SYS_FLG, X_RANKING_NUM, X_RB_CHANGE_DT, X_ROLE_CD, X_SIGNAL_TYPE_CD, X_SOURCE, X_SOURCE_2, X_START_DT, X_STAT_CD, X_TARGET_GRP_CD, X_PART_KEY, DATASOURCE_NUM_ID, DELETE_FLG, DELIVERY_SQN FROM STI_WC_ACCNT_SRC_G WHERE INTEGRATION_ID = '1-3456Abc011245' and delivery_sqn = $myDelSqn-!|
|column name  |INTEGRATION_ID       |CREATED                         |CREATED_BY  |LAST_UPD                        |LAST_UPD_BY    |ACTIVE_FLG  |ACTL_BILL_BACK  |ACTL_DISPLAY_COST  |ACTL_FEATURE_COST  |ACTL_NUM_RED_COUPN  |ACTL_NUM_SCAN_RED  |ACTL_OTHER_COST  |ACTL_SPENT_AMT  |ACTL_TOT_COUPON  |ACTL_VAL_COUPON  |ACTL_VAL_SCAN_RED  |ACTL_XINV_CASERATE  |ACTUAL_TGT_AMT  |ADVERT_DESC_TEXT  |ALLOCATED_AMT  |AMT_CURCY_CD  |AMT_DT  |ASGN_DT  |ATTRIB_01  |ATTRIB_02  |ATTRIB_03  |ATTRIB_04  |ATTRIB_05  |ATTRIB_06  |CMMT_BILL_BACK  |CMMT_DISPLAY_COST  |CMMT_FEATURE_COST  |CMMT_NUM_RED_COUPN  |CMMT_NUM_SCAN_RED  |CMMT_OTHER_COST  |CMMT_TOT_COUPON  |CMMT_VAL_COUPON  |CMMT_VAL_SCAN_RED  |CMMT_XINV_CASERATE  |COMMENTS  |COMMITTED_AMT  |COMMITTED_FLG  |CONFLICT_ID  |CONSUME_END_DT  |CONSUME_START_DT  |COUPON_DROP_FLG  |DB_LAST_UPD  |DB_LAST_UPD_SRC  |DISPLAY_FLG  |END_DT  |FEATURE_DT  |FEATURE_FLG  |FORWARD_BUY_AMT  |INCR_COST_PER_CASE |INCR_PROF_PER_CASE |INCR_VOLUME |X_SBL_INTEGRATION_ID |MODIFICATION_NUM |OBJECTIVE |OTH_COST_DSCTXT |OU_EXT_ID |PACKAGE_DESC_TEXT |PAR_ACCNT_SRC_ID |PAY_END_DT |PAY_EXPECT_DT |PAY_START_DT |PCT_LIFT |PERIOD_ID |PRICE_POINT |PRIMARY_FLG |PRI_LST_ID |PR_ACCNT_SRCPLN_ID |PR_ACCNT_SRC_PI_ID |READ_ONLY_FLG |RET_CAT_LIFT_PCT |RET_PROF_INCR_CASE |RET_PROMO_EFFIC |REV_DT |REV_NUM |SHIP_END_DT |SHIP_START_DT |SPENDING_EFFIC_IND |SRC_ID |START_DT |STATUS_CD |TGTREV_CURCY_CD |TGTREV_EXCH_DT |TGT_REVN |TMP_PRI_RDX_FLG |TMP_PRI_RDX_PCT |TURN_VOL_AMT |X_ASGN_USR_EXC_FLG |X_BU_ID |X_CALL_COMPLETED |X_CHANNEL_USED_CD |X_EXPIRATION_DT |X_FILE_NUM |X_FOLLOW_UP_FLG |X_FUNCTION_ID |X_OUTCOME_CD |X_PLAN_DT |X_POSTN_ID |X_PRIORITY_CD |X_PR_REP_DNRM_FLG |X_PR_REP_MANL_FLG |X_PR_REP_SYS_FLG |X_RANKING_NUM |X_RB_CHANGE_DT |X_ROLE_CD |X_SIGNAL_TYPE_CD |X_SOURCE |X_SOURCE_2 |X_START_DT |X_STAT_CD |X_TARGET_GRP_CD |X_PART_KEY |DATASOURCE_NUM_ID |DELETE_FLG |DELIVERY_SQN |
|column value |!-1-3456Abc011245-!  |!-2014-01-15 08:47:43.456321-!  |!-0-1-!     |!-2014-01-15 07:47:43.786795-!  |!-1-9X-9381-!  |!--!        |!--!            |!--!               |!--!               |!--!                |!--!               |!--!             |!--!            |!--!             |!--!             |!--!               |!--!                |!--!            |!--!              |!--!           |!-USD-!       |!--!    |!--!     |!--!       |!--!       |!--!       |!--!       |!--!       |!--!       |!--!            |!--!               |!--!               |!--!                |!--!               |!--!             |!--!             |!--!             |!--!               |!--!                |!--!      |!--!           |!--!           |!-0-!        |!--!            |!--!              |!--!             |!--!         |!--!             |!--!         |!--!    |!--!        |!--!         |!--!             |!--!               |!--!               |!--!        |!--!                 |!-6-!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |!-

Distributiekanaal: via intern communicatiesysteem Rabobank

Deze klant is in het kader van de actie EDM-Bedrijven geselecteerd. Deze klant heeft een lening waarvan de rentevast periode binnen twee maanden afloopt. U dient contact op te nemen met de klant. Meer informatie over dit signaal vindt u op het Raboweb onder Bedrijven/Informatie/Marktbewerking/EDM.

Leningnummer: 1049913027
Rentefixatiedatum: 28-02-2005
Boeksaldo: 50.878
Rest. looptyd (mnd): 112
Huidig rentetype: C
KBM-cluster: 3
Rente afspraak: Vast-!|!--!|!-1-3EEA-12-!|!--!|!--!|!--!|!-2005-01-14 07:01:00-!|!-2004-12-28 05:51:36-!|!--!|!--!|!--!|!--!|!--!|!--!|!--!|!-Y-!|!--!|!--!|!--!|!--!|!-1000004001-!|!--!|!--!|!--!|!-1-1O96-63-!|!--!|!--!|!--!|!--!|!--!|!--!|!--!|!--!|!--!|!-1-1U-253-!|!-Y-!|!--!|!--!|!--!|!--!|!--!|!--!|!-2005-01-14 07:01:00-!|!-1-9J-9399-!|!-3. Midden-!|!--!|!--!|!--!|!--!|!--!|!--!|!--!|!-CRIS-!|!-MDB-!|!--!|!-Afgehandeld-!|!--!|!-1049-!|!-1-!|!-N-!|!-$myDelSqn-!|


''' End Report  '''
