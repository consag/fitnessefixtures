---
Help
Suites
Test
---
!include -c <DatawarehouseDistribution.SettingUp
!define var_db_name_DWD {DWHD_IN}
!define var_db_name_RDV {DWHD_DATA}

!define var_RH_table {RH_ELSS_RA_FG}
!define var_interface_code {ELSS_RA_FINANCEGROUP}

|get query result                                                                                                                                                                                                                                                                                                                                                                                                                      |
|database name     |query                                                                                                                                                                                                                                                                                                                                                                                           |get column ?      |
|${var_db_name_DWD}|select delivery_sqn from (select a.delivery_sqn from MRV_DATA_DELIVERY a where  a.interface_code =  '${var_interface_code}' and exists (select 1 from mrv_data_delivery_detail where delivery_sqn = a.delivery_sqn and status = '2') and not exists (select 1 from mrv_data_delivery_detail where delivery_sqn = a.delivery_sqn and status = '6') order by a.delivery_sqn desc) where rownum = 1|$var_delivery_sqn=|

|get query result                                                                                             |
|database name     |query                                                                      |get column ?  |
|${var_db_name_RDV}|select count(*) from ${var_RH_table} where delivery_sqn = $var_delivery_sqn|$var_count_RH=|

|table:select query                                                                                                                                                                                     |
|database name |${var_db_name_DWD}                                                                                                                                                                      |
|sql statement |select count(*) as count_6 from mrv_data_delivery_detail mddd, mrv_data_delivery mdd where mddd.delivery_sqn = mdd.delivery_sqn and mddd.delivery_sqn = $var_delivery_sqn and status = 6|
|correct values|count_6                                                                                                                                                                                 |
|1             |0                                                                                                                                                                                       |

'''Rollback'''
|do workflows                                                                       |
|type of workflow|folder  |workflow name                       |workflow successful?|
|DWHD            |RDV_FINB|wf_RDV_ROLLBACK_ELSS_RA_FINANCEGROUP|Success             |

''Hub table will not be Rollbacked, count must be equal as before running Rollback workflow''
|table:select query                                                                                    |
|database name |${var_db_name_RDV}                                                                     |
|sql statement |select count(*) as count_RH from ${var_RH_table} where delivery_sqn = $var_delivery_sqn|
|correct values|count_RH                                                                               |
|1             |$var_count_RH                                                                          |

!define var_table_name {RHS_ELSS_RA_FG}
!include -c <FinancierenBedrijvenStagingIn.ElssBatch.IncludeScripts.CountRollback

!define var_table_name {RL_ELSS_RA_CLCN_X_ELSS_RA_FG}
!include -c <FinancierenBedrijvenStagingIn.ElssBatch.IncludeScripts.CountRollback

!define var_table_name {RL_ELSS_RA_FG_X_REL}
!include -c <FinancierenBedrijvenStagingIn.ElssBatch.IncludeScripts.CountRollback

!define var_table_name {RL_ELSS_RA_RG_X_ELSS_RA_FG}
!include -c <FinancierenBedrijvenStagingIn.ElssBatch.IncludeScripts.CountRollback


|table:select query                                                                                                                                                                                     |
|database name |${var_db_name_DWD}                                                                                                                                                                      |
|sql statement |select count(*) as count_6 from mrv_data_delivery_detail mddd, mrv_data_delivery mdd where mddd.delivery_sqn = mdd.delivery_sqn and mddd.delivery_sqn = $var_delivery_sqn and status = 6|
|correct values|count_6                                                                                                                                                                                 |
|1             |1                                                                                                                                                                                       |
